<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platto Partner | Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="owner-style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>

    <!-- Loader Screen -->
    <div id="loader" class="loader-overlay"><div class="spinner"></div></div>

    <!-- 1. AUTH & ONBOARDING AREA -->
    <div id="auth-area" style="display: block;">
        <!-- Login / Signup -->
        <section id="auth-section" class="flex-center">
            <div class="auth-card">
                <div class="brand-logo">PLATTO<span>Partner</span></div>
                <h2 id="auth-title">Partner Login</h2>
                <p id="auth-subtitle">Manage your restaurant digitally</p>
                <div class="input-group">
                    <label>Email Address</label>
                    <input type="email" id="email" placeholder="name@restaurant.com">
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button id="authBtn" class="primary-btn">Login</button>
                <div class="auth-footer">
                    <p id="toggle-wrapper">
                        New to Platto? <span onclick="toggleAuth()" style="color:#6366f1; cursor:pointer; font-weight:bold;">Create Account</span>
                    </p>
                </div>
            </div>
        </section>

        <!-- Membership Plans -->
        <section id="membership-section" class="container" style="display:none; padding: 40px 20px;">
            <h1 style="text-align:center;">Choose a Plan to Start</h1>
            <div class="plans-grid">
                <div class="plan-card" onclick="selectPlan('Monthly', 499)">
                    <h3>Monthly Plan</h3>
                    <p>‚Çπ499 / Mo</p>
                </div>
                <div class="plan-card featured" onclick="selectPlan('Yearly', 3999)">
                    <div class="badge">Value</div>
                    <h3>Yearly Plan</h3>
                    <p>‚Çπ3999 / Yr</p>
                </div>
            </div>
            <div id="payment-panel" class="card" style="display:none; margin-top:30px; text-align:center;">
                <h3>Pay ‚Çπ<span id="payable-amt">0</span> via UPI: <b style="color:#6366f1;">platto@okaxis</b></h3>
                <input type="text" id="res-name-input" placeholder="Restaurant Name">
                <input type="file" id="payment-proof" accept="image/*" style="margin: 15px 0;">
                <button id="submitPaymentBtn" class="primary-btn">Submit Proof</button>
            </div>
        </section>

        <!-- Waiting for Approval -->
        <section id="waiting-section" class="flex-center" style="display:none;">
            <div class="card" style="text-align:center;">
                <h2>‚è≥ Approval Pending</h2>
                <p>Admin is verifying your payment. Dashboard will unlock soon.</p>
            </div>
        </section>
    </div>

    <!-- 2. EXPIRED OVERLAY -->
    <div id="expired-screen" class="expired-overlay" style="display:none;">
        <div class="expired-card">
            <img src="https://cdn-icons-png.flaticon.com/512/564/564619.png" width="60">
            <h1>Plan Expired!</h1>
            <p>Aapki services stop kar di gayi hain. Dubara chalu karne ke liye renew karein.</p>
            <button class="primary-btn" onclick="goToRenewal()">Renew Now / Buy Plan</button>
        </div>
    </div>

    <!-- 3. MAIN DASHBOARD -->
    <div id="main-wrapper" style="display:none;" class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="side-logo">PLATTO<span>Partner</span></div>
            <nav class="side-nav">
                <button class="nav-link active" onclick="showSection('status')">üè† Status</button>
                <button class="nav-link" onclick="showSection('orders')">üîî Orders <span id="order-count-badge" class="badge-red">0</span></button>
                <button class="nav-link" onclick="showSection('profile')">üè¢ Profile</button>
                <button class="nav-link" onclick="showSection('menu')">üç¥ Menu</button>
                <button class="nav-link" onclick="showSection('payment-tab')">üí≥ Payment & Offers</button>
                <button class="nav-link" onclick="showSection('qr')">üñºÔ∏è QR Code</button>
                <button class="nav-link logout" onclick="logout()">üö™ Logout</button>
            </nav>
        </aside>

        <!-- Content Area -->
        <main class="content">
            <!-- Expiry Warning Banner -->
            <div id="expiry-warning" class="expiry-banner" style="display:none;">
                ‚ö†Ô∏è Aapka plan <span id="days-left">0</span> din mein khatam hoga. Kripya renew karein!
            </div>

            <!-- TAB: STATUS -->
            <section id="status-sec" class="page-sec">
                <h1>Dashboard, <span id="top-res-name">Partner</span></h1>
                <div class="status-grid">
                    <div class="stat-card"><small>Status</small><h2 id="disp-status">--</h2></div>
                    <div class="stat-card"><small>Plan</small><h2 id="disp-plan">--</h2></div>
                    <div class="stat-card"><small>Valid Till</small><h2 id="disp-expiry">--</h2></div>
                </div>
            </section>

            <!-- TAB: ORDERS (KDS) -->
            <section id="orders-sec" class="page-sec" style="display:none;">
                <div class="order-tabs">
                    <button class="tab-item active" onclick="switchOrderTab('Pending', this)">New <span id="count-new">0</span></button>
                    <button class="tab-item" onclick="switchOrderTab('Preparing', this)">Preparing <span id="count-prep">0</span></button>
                    <button class="tab-item" onclick="switchOrderTab('Ready', this)">Ready <span id="count-ready">0</span></button>
                    <button class="tab-item" onclick="switchOrderTab('Picked Up', this)">Picked Up <span id="count-picked">0</span></button>
                    <button class="tab-item" onclick="switchOrderTab('Past Orders', this)">History</button>
                </div>
                <div id="orders-display-grid" class="orders-grid-display"></div>
            </section>

            <!-- TAB: PROFILE -->
            <section id="profile-sec" class="page-sec" style="display:none;">
                <div class="card">
                    <h3>Restaurant Profile</h3>
                    <div class="form-grid">
                        <div class="full-width"><label>Change Logo</label><input type="file" id="res-logo-file"></div>
                        <input type="text" id="res-name" placeholder="Restaurant Name">
                        <input type="text" id="res-phone" placeholder="Call Button Number">
                        <input type="number" id="res-prep-time" placeholder="Avg Prep Time (Mins)">
                        <textarea id="res-address" class="full-width" placeholder="Full Address"></textarea>
                    </div>
                    <button class="primary-btn" onclick="saveProfile()">Update Profile</button>
                </div>
            </section>

            <!-- TAB: MENU -->
            <section id="menu-sec" class="page-sec" style="display:none;">
                <div class="card">
                    <h3>Add New Menu Item</h3>
                    <div class="form-grid">
                        <input type="text" id="item-name" placeholder="Item Name">
                        <input type="number" id="item-price" placeholder="Price">
                        <input type="file" id="item-img">
                        <button class="primary-btn" onclick="addMenuItem()">Add Item</button>
                    </div>
                </div>
                <div id="owner-menu-list" class="menu-display-grid"></div>
            </section>

            <!-- TAB: PAYMENT & OFFERS -->
            <section id="payment-tab-sec" class="page-sec" style="display:none;">
                <div class="card">
                    <h3>Payment UPI Settings</h3>
                    <input type="text" id="res-upi" placeholder="Your UPI ID (e.g. name@upi)">
                    <input type="file" id="res-qr-file" accept="image/*">
                    <button class="primary-btn" onclick="savePaymentInfo()" style="margin-top:10px;">Save Payment</button>
                </div>
                <div class="card" style="margin-top:20px;">
                    <h3>Discount & Offer Control</h3>
                    <input type="text" id="offer-text" placeholder="Offer Text (e.g. 10% OFF)">
                    <label><input type="checkbox" id="offer-status"> Show Offer to Customers?</label>
                    <button class="primary-btn" onclick="saveOffer()" style="margin-top:10px;">Save Offer</button>
                </div>
            </section>

            <!-- TAB: QR GENERATOR -->
            <section id="qr-sec" class="page-sec" style="display:none; text-align:center;">
                <div class="card">
                    <h3>Restaurant Menu QR Code</h3>
                    <div id="qrcode-box" style="display:flex; justify-content:center; margin:20px;"></div>
                    <button class="primary-btn" onclick="downloadQR()">Download QR Code</button>
                </div>
            </section>
        </main>
    </div>

    <!-- Script Import -->
    <script type="module" src="owner-script.js"></script>
</body>
</html>